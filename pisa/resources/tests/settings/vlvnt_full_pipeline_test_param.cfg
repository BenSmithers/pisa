[pipeline]

order = flux:honda, osc:prob3gpu, aeff:param, reco:param, pid:param
param_selections = nh

[binning]

full_test_binning_true.order = true_energy, true_coszen
full_test_binning_true.true_energy = {'num_bins':35, 'is_log':True, 'domain': [1, 80] * units.GeV, 'tex': r'$E_{\rm true}$'}
full_test_binning_true.true_coszen = {'num_bins':20, 'is_lin':True, 'domain': [-1, 0], 'tex':r'$\cos\,\theta_{Z,{\rm true}}$'}

full_test_binning_reco.order = reco_energy, reco_coszen
full_test_binning_reco.reco_energy = {'num_bins':35, 'is_log':True, 'domain': [1, 80] * units.GeV, 'tex': r'$E_{\rm reco}$'}
full_test_binning_reco.reco_coszen = {'num_bins':20, 'is_lin':True, 'domain': [-1, 0], 'tex':r'$\cos\,\theta_{Z,{\rm reco}}$'}

true_upgoingfine.order = true_coszen, true_energy
true_upgoingfine.true_energy = {'num_bins':350, 'is_log':True, 'domain':[1,80] * units.GeV, 'tex': r'$E_{\rm true}$'}
true_upgoingfine.true_coszen = {'num_bins':200, 'is_lin':True, 'domain':[-1,0], 'tex':r'$\cos\,\theta_{Z,{\rm true}}$'}

[stage:flux]

output_binning = true_upgoingfine

error_method = None
debug_mode = False
outputs_cache_depth = 0
memcache_deepcopy = True

param.oversample_cz = 1
param.oversample_e = 1

param.flux_file = flux/honda-2015-spl-solmin-aa.d
param.flux_mode = integral-preserving

param.atm_delta_index = 0.0 +/- 0.05
param.atm_delta_index.fixed = True
param.atm_delta_index.range = nominal + [-4., +4.] * sigma

param.energy_scale = 1.0 +/- 0.1
param.energy_scale.fixed = True
param.energy_scale.range = nominal + [-3., +3.] * sigma

param.nu_nubar_ratio = 1.0 +/- 0.1
param.nu_nubar_ratio.fixed = True
param.nu_nubar_ratio.range = nominal + [-3., +3.] * sigma

param.nue_numu_ratio = 1.0 +/- 0.03
param.nue_numu_ratio.fixed = True
param.nue_numu_ratio.range = nominal + [-10., +10.] * sigma

[stage:osc]

input_binning = <!stage:flux|output_binning!>
output_binning = full_test_binning_true

error_method = None
debug_mode = False
transforms_cache_depth = 0
outputs_cache_depth = <!stage:flux|outputs_cache_depth!>
memcache_deepcopy = <!stage:flux|memcache_deepcopy!>

param.earth_model = osc/PREM_12layer.dat

param.YeI = 0.4656
param.YeM = 0.4957
param.YeO = 0.4656

param.detector_depth = 2. units.km
param.prop_height = 20. units.km

param.theta12 =  0.5857324969692971 units.rad
param.theta12.fixed = True

param.theta13 = 0.148352986419518 units.rad
param.theta13.fixed = True

param.theta23 = 0.7853981633974483 units.rad
param.theta23.fixed = True

param.deltacp = <!pisav2unitmatch|deltacp!>
param.deltacp.fixed = True

param.deltam21 = <!pisav2unitmatch|deltam21!>
param.deltam21.fixed = True

param.deltam31 = 0.002524 units.eV**2
param.deltam31.fixed = True

param.nutau_norm = 1

[stage:aeff]

input_binning = full_test_binning_true
output_binning = full_test_binning_true

particles = neutrinos
input_names = nue, nuebar, numu, numubar, nutau, nutaubar
transform_groups = nuall_nc, nuallbar_nc
sum_grouped_flavints = True

error_method = None
debug_mode = False
transforms_cache_depth = 0
outputs_cache_depth = 0
memcache_deepcopy = False

# params

param.aeff_energy_paramfile = aeff/vlvnt/vlvnt_aeff_energy_param.json
param.aeff_coszen_paramfile = aeff/vlvnt/vlvnt_aeff_coszen_param.json
param.transform_events_keep_criteria = None

param.livetime = 1. units.julian_year

param.aeff_scale = 1.
param.aeff_scale.fixed = False
param.aeff_scale.range = nominal + [-0.3, +0.3]
param.aeff_scale.prior = uniform

param.nutau_cc_norm = 1.
param.nutau_cc_norm.fixed = False
param.nutau_cc_norm.prior = uniform
param.nutau_cc_norm.range = [-1.0, 3.0] * units.dimensionless

[stage:reco]

input_binning = full_test_binning_true
output_binning = full_test_binning_reco

particles = neutrinos
input_names = nue_cc, numu_cc, nutau_cc, nuebar_cc, numubar_cc, nutaubar_cc, nuall_nc, nuallbar_nc
transform_groups = nue_cc+nuebar_cc, numu_cc+numubar_cc, nutau_cc+nutaubar_cc, nuall_nc+nuallbar_nc
sum_grouped_flavints = True

error_method = None
debug_mode = False

coszen_flipback = True

# params

param.reco_paramfile = reco/vlvnt/vlvnt_reco_param.json

param.res_scale_ref = zero
param.e_res_scale = 1.0
param.cz_res_scale = 1.0

param.e_reco_bias = 0 * units.GeV
param.cz_reco_bias = 0


[stage:pid]

input_binning = full_test_binning_reco
output_binning = full_test_binning_reco

particles = neutrinos
input_names = nue_cc+nuebar_cc, numu_cc+numubar_cc, nutau_cc+nutaubar_cc, nuall_nc+nuallbar_nc
transform_groups = nue_cc+nuebar_cc, numu_cc+numubar_cc, nutau_cc+nutaubar_cc, nuall_nc+nuallbar_nc

error_method = None
debug_mode = False
transforms_cache_depth = 0
outputs_cache_depth = 0
memcache_deepcopy = True

param.pid_energy_paramfile = pid/vlvnt/vlvnt_pid_energy_param.json

[pisav2unitmatch]
theta12 = 0.584 units.rad
theta12.fixed = True

theta13 = 0.148 +/- 0.003490658503988659 units.rad
theta13.fixed = False

theta23_nh = 0.7382742735936013 units.rad
theta23_nh.fixed = False
theta23_nh.prior = uniform

theta23_ih = 0.8639379797371931 units.rad
theta23_ih.fixed = False
theta23_ih.prior = uniform

deltacp = 0 units.rad
deltacp.fixed = True

deltam21 = 7.5e-5 units.eV**2
deltam21.fixed = True

deltam31_nh = 2.457e-3 units.eV**2
deltam31_nh.fixed = False
deltam31_nh.prior = uniform

deltam31_ih = -2.37e-3 units.eV**2
deltam31_ih.fixed = False
deltam31_ih.prior = uniform
